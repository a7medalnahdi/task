
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Task Manager - Polished Final</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Cairo', sans-serif; }
    body.dark { background-color: #1b1819; color: white; }
    body.light { background-color: #ffefe5; color: black; }
    .input-dark { background-color: #3a3a3a; color: white; }
    .input-light { background-color: #d1d5d8; color: black; }
    .input-common { padding: 0.75rem; border-radius: 0.75rem; width: 100%; border: none; }
    .section-card { border-radius: 1.5rem; padding: 2rem; }
    .switch { background: #eee; border-radius: 9999px; width: 70px; height: 36px; display: flex; align-items: center; justify-content: space-between; padding: 4px; position: relative; cursor: pointer; }
    .switch-icon { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
    .switch.active .sun { background: #2563eb; color: white; }
    .switch:not(.active) .moon { background: #4b5563; color: white; }
    .badge { font-weight: bold; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; }
    select { appearance: none; background-image: none !important; }
  </style>
</head>
<body class="dark">
  <div id="app"></div>
  <script>
    const app = document.getElementById("app");

    let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");
    let editId = null;
    let darkMode = true;

    const departments = {
      "ÙƒØ±ÙŠÙŠØªÙ": "#a3e635", "Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§": "#f472b6", "Ù…Ø§Ø±ÙƒØªÙ†Ù‚": "#f87171",
      "ÙƒÙˆØ§Ù„ÙŠØªÙŠ": "#fde047", "Ø§Ù„Ø´Ø±Ø§ÙƒØ§Øª": "#34d399", "Ø³ÙˆÙŠØªØ±": "#60a5fa",
      "Ø§ÙˆØ¨Ø±ÙŠØ´Ù†": "#a78bfa", "Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡": "#fb923c", "ØªÙ‚Ù†ÙŠØ©": "#22d3ee"
    };

    const statuses = {
      "ØºÙŠØ± Ù…Ù†Ø¬Ø²": "#e74c3c", "Ù…Ù†Ø¬Ø²": "#27ae60", "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„": "#3498db",
      "Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±Ø¯": "#8e44ad", "Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰": "#f39c12",
      "Ù…Ø¹Ù„Ù‚": "#6e4d2b", "Ù…Ù„ØºÙŠ": "#000", "Ø§Ù‡Ù…ÙŠØ©": "#2ecc71"
    };

    function render() {
      const modeClass = darkMode ? "dark" : "light";
      const inputClass = `input-common ${darkMode ? "input-dark" : "input-light"}`;
      document.body.className = modeClass;

      app.innerHTML = `
        <div class="max-w-7xl mx-auto px-4 py-6 space-y-10">
          <div class="flex justify-between items-center">
            <h1 class="text-2xl font-bold">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h1>
            <div class="switch ${!darkMode ? 'active' : ''}" onclick="toggleMode()">
              <div class="switch-icon sun">â˜€ï¸</div>
              <div class="switch-icon moon">ğŸŒ™</div>
            </div>
          </div>

          <div class="section-card ${darkMode ? 'bg-[#2b292a]' : 'bg-white'} shadow-md">
            <h2 class="text-[#ef5b0c] text-xl font-bold mb-6 border-b pb-2">Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              ${["title","requester","type","size","link","deadline"].map(id => `
                <input id="${id}" class="${inputClass}" placeholder="${id}" type="${id==='deadline'?'date':'text'}" />
              `).join('')}
              <select id="department" class="${inputClass}">
                ${Object.keys(departments).map(d => `<option>${d}</option>`).join('')}
              </select>
              <textarea id="description" class="${inputClass} col-span-full" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨"></textarea>
            </div>
            <button onclick="addTask()" class="mt-4 w-full bg-[#ef5b0c] text-white py-3 rounded-xl font-bold hover:bg-orange-600">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨</button>
          </div>

          <div class="section-card ${darkMode ? 'bg-[#2b292a]' : 'bg-white'} shadow-md">
            <h2 class="text-[#ef5b0c] text-xl font-bold mb-4 border-b pb-2">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6" id="tasks">
              ${tasks.map(task => `
                <div class="p-6 rounded-2xl border border-gray-600 ${darkMode ? 'bg-[#2f2f2f] text-white' : 'bg-gray-100 text-black'} shadow-lg hover:scale-105 transition-transform duration-300">
                  <div class="flex justify-between items-center mb-4">
                    <span class="px-3 py-1 text-xs font-semibold rounded-full" style="background:${departments[task.department]}; color:#000">${task.department}</span>
                    <span class="px-3 py-1 text-xs font-semibold rounded-full" style="background:${statuses[task.status]}; color:#fff">${task.status}</span>
                  </div>
                  <h2 class="text-lg font-bold mb-2">${task.title}</h2>
                  <div class="space-y-1 text-sm text-gray-300">
                    <p>ğŸ‘¤ <span class="font-medium text-white">${task.requester || "--"}</span></p>
                    <p>ğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø³: ${task.size || "--"}</p>
                    <p>ğŸ¨ Ø§Ù„Ù†ÙˆØ¹: ${task.type || "--"}</p>
                    <p>ğŸ“… Ø§Ù„ØªØ³Ù„ÙŠÙ…: ${task.deadline || "--"}</p>
                    <p>ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø·: <a href="${task.link}" class="text-blue-400 underline">Ø±Ø§Ø¨Ø·</a></p>
                  </div>
                  <div class="flex justify-between items-center mt-6">
                    <button onclick="editTask(${task.id})" class="bg-blue-600 text-white px-5 py-1.5 rounded-full text-sm hover:bg-blue-700 transition">ØªØ¹Ø¯ÙŠÙ„</button>
                    <button onclick="removeTask(${task.id})" class="bg-red-600 text-white px-5 py-1.5 rounded-full text-sm hover:bg-red-700 transition">Ø­Ø°Ù</button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function val(id) { return document.getElementById(id)?.value || "--"; }

    function addTask() {
      const task = {
        id: editId ?? Date.now(),
        title: val("title"), requester: val("requester"),
        type: val("type"), size: val("size"),
        link: val("link"), deadline: val("deadline"),
        description: val("description"), department: val("department"),
        status: "ØºÙŠØ± Ù…Ù†Ø¬Ø²"
      };
      tasks = editId ? tasks.map(t => t.id === editId ? task : t) : [...tasks, task];
      editId = null;
      localStorage.setItem("tasks", JSON.stringify(tasks));
      render();
    }

    function updateStatus(id, status) {
      tasks = tasks.map(t => t.id === id ? { ...t, status } : t);
      localStorage.setItem("tasks", JSON.stringify(tasks));
      render();
    }

    function editTask(id) {
      const t = tasks.find(t => t.id === id);
      Object.keys(t).forEach(key => {
        const el = document.getElementById(key);
        if (el) el.value = t[key];
      });
      editId = id;
    }

    function removeTask(id) {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ")) {
        tasks = tasks.filter(t => t.id !== id);
        localStorage.setItem("tasks", JSON.stringify(tasks));
        render();
      }
    }

    function toggleMode() {
      darkMode = !darkMode;
      render();
    }

    render();
  </script>
</body>
</html>
