
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Task Manager - Final</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    body.dark { background-color: #1b1819; color: white; }
    body.light { background-color: #ffefe5; color: black; }
    .card { border-radius: 1.5rem; padding: 2rem; margin-bottom: 2rem; }
    .input { border-radius: 0.75rem; padding: 0.75rem; }
  </style>
</head>
<body class="dark">
  <div id="app"></div>
  <script type="module">
    const app = document.getElementById("app");

    let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");
    let editId = null;
    let darkMode = true;

    const departments = [
      "ÙƒØ±ÙŠÙŠØªÙ","Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§","Ù…Ø§Ø±ÙƒØªÙ†Ù‚","ÙƒÙˆØ§Ù„ÙŠØªÙŠ","Ø§Ù„Ø´Ø±Ø§ÙƒØ§Øª","Ø³ÙˆÙŠØªØ±","Ø§ÙˆØ¨Ø±ÙŠØ´Ù†","Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡","ØªÙ‚Ù†ÙŠØ©"
    ];
    const statuses = {
      "ØºÙŠØ± Ù…Ù†Ø¬Ø²": "#e74c3c", "Ù…Ù†Ø¬Ø²": "#27ae60", "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„": "#3498db",
      "Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±Ø¯": "#8e44ad", "Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰": "#f39c12",
      "Ù…Ø¹Ù„Ù‚": "#6e4d2b", "Ù…Ù„ØºÙŠ": "#000", "Ø§Ù‡Ù…ÙŠØ©": "#2ecc71"
    };

    function render() {
      app.innerHTML = `
        <div class="max-w-7xl mx-auto px-4 py-6 space-y-6">
          <div class="flex justify-between items-center">
            <h1 class="text-2xl font-bold">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h1>
            <button class="bg-[#ef5b0c] text-white px-4 py-2 rounded-full text-sm" onclick="toggleMode()">
              ${darkMode ? "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ â˜€ï¸" : "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ğŸŒ™"}
            </button>
          </div>
          <div class="card ${darkMode ? 'bg-[#2b292a]' : 'bg-white'}">
            <h2 class="text-[#ef5b0c] text-xl font-bold mb-4">Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              ${["title","requester","type","size","link","deadline"].map(id => `
                <input id="${id}" class="input ${darkMode ? 'bg-[#3a3a3a] text-white' : 'bg-[#d1d5d8] text-black'}" placeholder="${id}" type="${id==='deadline'?'date':'text'}" />
              `).join('')}
              <select id="department" class="input ${darkMode ? 'bg-[#3a3a3a] text-white' : 'bg-[#d1d5d8] text-black'}">
                ${departments.map(d => `<option>${d}</option>`).join('')}
              </select>
              <textarea id="description" class="input col-span-full ${darkMode ? 'bg-[#3a3a3a] text-white' : 'bg-[#d1d5d8] text-black'}" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨"></textarea>
            </div>
            <button onclick="addTask()" class="mt-4 w-full bg-[#ef5b0c] text-white py-3 rounded-xl font-bold hover:bg-orange-600">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨</button>
          </div>
          <div class="card ${darkMode ? 'bg-[#2b292a]' : 'bg-white'}">
            <h2 class="text-[#ef5b0c] text-xl font-bold mb-4">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4" id="tasks">
              ${tasks.map(task => `
                <div class="p-4 rounded-2xl border border-gray-500 ${darkMode ? 'bg-[#2f2f2f] text-white' : 'bg-gray-100 text-black'}">
                  <div class="flex justify-between mb-2">
                    <span class="text-xs font-bold px-3 py-1 rounded-full bg-gray-300 text-black">${task.department}</span>
                    <select onchange="updateStatus(${task.id}, this.value)" class="text-xs font-bold px-3 py-1 rounded-full" style="background:${statuses[task.status]}; color:white">
                      ${Object.keys(statuses).map(s => `<option ${s===task.status?'selected':''}>${s}</option>`).join('')}
                    </select>
                  </div>
                  <h3 class="font-bold text-lg">${task.title}</h3>
                  <p class="text-sm">ØµØ§Ø­Ø¨ Ø§Ù„Ø·Ù„Ø¨: ${task.requester}</p>
                  <a href="${task.link}" target="_blank" class="text-blue-400 underline text-sm">Ø±Ø§Ø¨Ø·</a>
                  <div class="flex justify-between pt-4">
                    <button onclick="editTask(${task.id})" class="text-xs text-blue-400">ØªØ¹Ø¯ÙŠÙ„</button>
                    <button onclick="removeTask(${task.id})" class="text-xs text-red-400">Ø­Ø°Ù</button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function val(id) { return document.getElementById(id)?.value || "--"; }

    window.addTask = () => {
      const task = {
        id: editId ?? Date.now(),
        title: val("title"), requester: val("requester"),
        type: val("type"), size: val("size"),
        link: val("link"), deadline: val("deadline"),
        description: val("description"), department: val("department"),
        status: "ØºÙŠØ± Ù…Ù†Ø¬Ø²"
      };
      tasks = editId ? tasks.map(t => t.id === editId ? task : t) : [...tasks, task];
      editId = null;
      localStorage.setItem("tasks", JSON.stringify(tasks));
      render();
    };

    window.updateStatus = (id, status) => {
      tasks = tasks.map(t => t.id === id ? { ...t, status } : t);
      localStorage.setItem("tasks", JSON.stringify(tasks));
      render();
    };

    window.editTask = (id) => {
      const t = tasks.find(t => t.id === id);
      Object.keys(t).forEach(key => {
        const el = document.getElementById(key);
        if (el) el.value = t[key];
      });
      editId = id;
    };

    window.removeTask = (id) => {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ")) {
        tasks = tasks.filter(t => t.id !== id);
        localStorage.setItem("tasks", JSON.stringify(tasks));
        render();
      }
    };

    window.toggleMode = () => {
      darkMode = !darkMode;
      document.body.className = darkMode ? 'dark' : 'light';
      render();
    };

    render();
  </script>
</body>
</html>
